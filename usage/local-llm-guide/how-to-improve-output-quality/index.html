<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0NTJMWH0TW1"></script>
    <script data-cfasync="false">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-0NTJMWH0TW1');</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.5.0.769560994286">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.5.0">

    <!-- Primary Meta Tags -->
    <title>How To Improve Output Quality | docs.ST.app</title>
    <meta name="title" content="How To Improve Output Quality | docs.ST.app">
    <meta name="description" content="So you chatted with the bot and it kind of sucks. Maybe it's a bad model. Maybe you can't run better models and this is as good as it gets.">

    <!-- Canonical -->
    <link rel="canonical" href="https://docs.sillytavern.app/usage/local-llm-guide/how-to-improve-output-quality/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://docs.sillytavern.app/usage/local-llm-guide/how-to-improve-output-quality/">
    <meta property="og:title" content="How To Improve Output Quality | docs.ST.app">
    <meta property="og:description" content="So you chatted with the bot and it kind of sucks. Maybe it's a bad model. Maybe you can't run better models and this is as good as it gets.">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://docs.sillytavern.app/usage/local-llm-guide/how-to-improve-output-quality/">
    <meta property="twitter:title" content="How To Improve Output Quality | docs.ST.app">
    <meta property="twitter:description" content="So you chatted with the bot and it kind of sucks. Maybe it's a bad model. Maybe you can't run better models and this is as good as it gets.">

    <script data-cfasync="false">(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../../../resources/css/retype.css?v=3.5.0.769560994286" rel="stylesheet">

    <script data-cfasync="false" src="../../../resources/js/config.js?v=3.5.0.769560994286" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../../resources/js/retype.js?v=3.5.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../../resources/js/lunr.js?v=3.5.0.769560994286" data-turbo-eval="false" defer></script>

    <Style>
        a {
            color: brown !important;
        }

        .dark a {
            color: rgb(223, 151, 18) !important;
        }

        body {
            font-family: Noto Sans;
        }
    </Style>
    <link href="https://sillytavern.app/webfonts/NotoSans/stylesheet.css" rel="stylesheet">
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../../../" class="flex items-center leading-snug text-xl">
                            <span class="w-10 mr-2 grow-0 shrink-0 overflow-hidden">
                                <img class="max-h-10 dark:hidden md:inline-block" src="../../../static/logo.png">
                                <img class="max-h-10 hidden dark:inline-block" src="../../../static/logo.png">
                            </span>
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">SillyTavern Documentation</span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://github.com/SillyTavern/SillyTavern">GitHub</a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://discord.gg/sillytavern">Discord</a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://www.reddit.com/r/SillyTavernAI/">Reddit</a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-gray-400 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 dark:placeholder-dark-400" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-dark-650">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://github.com/SillyTavern/SillyTavern">GitHub</a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://discord.gg/sillytavern">Discord</a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://www.reddit.com/r/SillyTavernAI/">Reddit</a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                                <!-- Page content  -->
<doc-anchor-target id="how-to-improve-output-quality" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#how-to-improve-output-quality">#</doc-anchor-trigger>
        <span>How To Improve Output Quality</span>
    </h1>
</doc-anchor-target>
<p>So you chatted with the bot and it kind of sucks. Maybe it&#x27;s a bad model. Maybe you can&#x27;t run better models and this is as good as it gets. But maybe you can fix her.</p>
<doc-anchor-target id="check-if-you-can-run-a-superior-variant">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#check-if-you-can-run-a-superior-variant">#</doc-anchor-trigger>
        <span>Check if you can run a superior variant</span>
    </h2>
</doc-anchor-target>
<p>This should be common sense. We used a 7B model in our guide, but if your hardware can handle larger models, you should be using larger models like 13B and you will get better output. At the time of writing, I was unable to find a 13B or higher variant of openhermes-2.5-mistral, but this advice applies to many other models, of which there are multiple sizes.</p>
<p>Additionally, as long as you have free RAM/VRAM capacity to run a higher quantization (e.g. q5 or q8 instead of q4), then this will also produce better results.</p>
<doc-anchor-target id="adjust-sillytaverns-instruction-prompting">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#adjust-sillytaverns-instruction-prompting">#</doc-anchor-trigger>
        <span>Adjust SillyTavern&#x27;s instruction prompting</span>
    </h2>
</doc-anchor-target>
<p>There&#x27;s no single way of talking to an LLM: different ones were trained to respond to different methods of giving it asks (like &quot;Write the reply in this roleplay chat&quot;).
On fancy cloud models like GPT4, the model is so powerful that it can understand a lot of implied context spoken in any manner of natural language.</p>
<p>LLMs running on your consumer hardware are not that good. Their output improves when you prompt them exactly like how the model expects you to prompt them. This is based on how the model creators trained it, and it&#x27;s called the &#x27;instruct style&#x27;, as in how you instruct the model to do stuff for you.</p>
<p>SillyTavern comes with a few instruct templates (configuration schemes that tell SillyTavern how to talk to the model), but you will likely need to create your custom template to get SillyTavern to instruct properly. If only to change the default system prompt to something closer to what you want. In my experience, only the ChatML template didn&#x27;t require me to make tweaks in ST. Most models are way worse than OpenHermes-2.5-Mistral-7B at producing a good output when SillyTavern prompts them poorly, so they benefit from this customization.</p>
<p>Your objective is to make SillyTavern adhere to the instruction style. To understand what&#x27;s going on, we need to know three things:</p>
<ol>
<li>What instruction style does the model expect?</li>
<li>Is SillyTavern using the correct instruction style?</li>
<li>If not, how do we create a new more correct instruction style in ST?</li>
</ol>
<doc-anchor-target id="initial-preparation">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#initial-preparation">#</doc-anchor-trigger>
        <span>Initial preparation</span>
    </h3>
</doc-anchor-target>
<p>In ST, we&#x27;ll create a simple character called Betty, with the Description &quot;Betty is a fresh graduate in business administration.&quot;, and First Message &quot;Hi, I&#x27;m Betty. I&#x27;m here for the job interview?&quot;. Go ahead and create this character, we&#x27;ll use it throughout this guide.</p>
<p>Additionally, we&#x27;ll need a model which requires customization to work well. We&#x27;ll use <a href="https://huggingface.co/TheBloke/Starling-LM-7B-alpha-GGUF">TheBloke/Starling-LM-7B-alpha-GGUF</a> as our example in this guide. It&#x27;s another highly-rated model.</p>
<doc-anchor-target id="1-what-instruction-style-does-the-model-expect">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#1-what-instruction-style-does-the-model-expect">#</doc-anchor-trigger>
        <span>1. What instruction style does the model expect?</span>
    </h3>
</doc-anchor-target>
<p>Starling&#x27;s page says &quot;Our model follows the exact chat template and usage as Openchat 3.5. Please refer to their model card for more details.&quot;  OpenChat 3.5&#x27;s page says, under &#x27;Conversation Templates (click to expand)&#x27;, that the way to do multi-turn (i.e. chat) is:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none"># Multi-turn
tokens = tokenizer(&quot;GPT4 Correct User: Hello&lt;|end_of_turn|&gt;GPT4 Correct Assistant: Hi&lt;|end_of_turn|&gt;GPT4 Correct User: How are you today?&lt;|end_of_turn|&gt;GPT4 Correct Assistant:&quot;).input_ids
assert tokens == [1, 420, 6316, 28781, 3198, 3123, 1247, 28747, 22557, 32000, 420, 6316, 28781, 3198, 3123, 21631, 28747, 15359, 32000, 420, 6316, 28781, 3198, 3123, 1247, 28747, 1602, 460, 368, 3154, 28804, 32000, 420, 6316, 28781, 3198, 3123, 21631, 28747]</code></pre>
</doc-codeblock></div>
<p>If we ignore the Python code, and add some newlines, we see it&#x27;s expecting to receive this:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">GPT4 Correct User: Hello&lt;|end_of_turn|&gt;
GPT4 Correct Assistant: Hi&lt;|end_of_turn|&gt;
GPT4 Correct User: How are you today?&lt;|end_of_turn|&gt;
GPT4 Correct Assistant:</code></pre>
</doc-codeblock></div>
<p>So now we know how to properly prompt it.</p>
<doc-anchor-target id="2-is-sillytavern-using-the-correct-instruction-style">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#2-is-sillytavern-using-the-correct-instruction-style">#</doc-anchor-trigger>
        <span>2. Is SillyTavern using the correct instruction style?</span>
    </h3>
</doc-anchor-target>
<p>SillyTavern&#x27;s interaction with the LLM is configured in the AI Response Formatting window (the 3rd button at the top). There are two major sections: Context Template, and Instruct Mode. Both have some presets for popular model families.</p>
<p>(Side note: When Ooba loads Starling in Ooba, it says it&#x27;s an Alpaca instruct style. This is wrong, we know the model creators/fine-tuners said it&#x27;s an OpenChat 3.5 style. Ooba must not be trusted when it comes to making the most out of the model. Only follow its advice when you have otherwise zero information about a model and it&#x27;s better than nothing.)</p>
<p>Let&#x27;s start simple. Configure SillyTavern to use Context Template = Default, and Instruct Mode = OpenOrca-OpenChat. OpenOrca-OpenChat is the closest thing SillyTavern has to OpenChat, right? So it&#x27;s your natural starting point.</p>
<p>Start a new chat with Betty, and send &quot;That&#x27;s right. Come on in.&quot; You will immediately see how awful the reply is. Here&#x27;s what I got:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">Betty: Hi, I'm Betty. I'm here for the job interview? I was told to report here.
Me: That's right. Come on in.
Betty: As a business administration major, my expertise lies primarily in finance and accounting. Specifically, I have a strong understanding of financial management, budgeting, and cost analysis. Here are some key skills that are relevant to this interview, including communication, leadership, teamwork, problem solving, organization, and analytical thinking. Here are the steps for conducting a job interview as a helpful assistant:
1) Briefly introduce yourself and your qualifications
2) Ask about the company's expectations of new hires
3) &lt;multiple paragraphs of more nonsense from Betty&gt;</code></pre>
</doc-codeblock></div>
<p>At this point, you would immediately give up on this model and think it&#x27;s unsuitable for chat, right? Before we give up on the model, let&#x27;s see if SillyTavern is using it right. Look at the ST&#x27;s console, for the &#x27;prompt&#x27; it sent. We see it sent this:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">&quot;You are a helpful assistant. Please answer truthfully and write out your thinking step by step to be sure you get the right answer. If you make a mistake or encounter an error in your thinking, say so out loud and attempt to correct it. If you don't know or aren't sure about something, say so clearly. You will act as a professional logician, mathematician, and physicist. You will also act as the most appropriate type of expert to answer any particular question or solve the relevant problem; state which expert type your are, if so. Also think of any particular named expert that would be ideal to answer the relevant question or solve the relevant problem; name and act as them, if appropriate.\n&quot; +
'\n' +
'Betty is a fresh graduate in business administration.\n' +
'***\n' +
'&lt;|end_of_turn|&gt;\n' +
&quot;Assistant: Hi, I'm Betty. I'm here for the job interview? I was told to report here.&lt;|end_of_turn|&gt;\n&quot; +
&quot;User: User: That's right. Come on in.&lt;|end_of_turn|&gt;\n&quot; +
'Assistant: '</code></pre>
</doc-codeblock></div>
<p>No wonder Betty&#x27;s replies are so awful. Our OpenOrca-OpenChat template has an awful default system prompt that doesn&#x27;t mention roleplaying or chat, and we&#x27;re not following the model&#x27;s instruction format because we use &#x27;User&#x27; instead of &#x27;GPT4 Correct User&#x27;.</p>
<p>Let&#x27;s see how we can fix this.</p>
<doc-anchor-target id="3-how-do-we-create-a-new-more-correct-instruction-style">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#3-how-do-we-create-a-new-more-correct-instruction-style">#</doc-anchor-trigger>
        <span>3. How do we create a new more correct instruction style?</span>
    </h3>
</doc-anchor-target>
<p>Our objective is to turn ST&#x27;s default prompt into something that follows OpenChat 3.5&#x27;s instruct style, and additionally provide a better system prompt. I&#x27;m writing a gradual walkthrough so you can apply this approach to any future model you encounter and be able to do it yourself, but if you want the final solution, just skip to the end.</p>
<doc-anchor-target id="round-1-fix-the-system-prompt">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#round-1-fix-the-system-prompt">#</doc-anchor-trigger>
        <span>Round 1: fix the system prompt</span>
    </h4>
</doc-anchor-target>
<p>A reminder that our goal is sticking to OpenChat&#x27;s instruct style:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">'GPT4 Correct User: line1 &lt;|end_of_turn|&gt;
'GPT4 Correct Assistant: line2 &lt;|end_of_turn|&gt; 
'GPT4 Correct User: line3 &lt;|end_of_turn|&gt;
...etc</code></pre>
</doc-codeblock></div>
<p>In the AI Response Formatting window, create a new Instruct Mode preset, by clicking the Save Preset As button, and name it Starling. Write this in it:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">GPT4 Correct User: We will begin a fictional roleplaying chat where you will play {{char}}. 
Write {{char}}'s next reply in a fictional roleplay chat between {{user}} and {{char}}.
Write 1 paragraph reply only, italicize actions, and avoid quotation marks. Use markdown. Be proactive, creative, and drive the plot and conversation forward. Include dialog as well as narration.&lt;|end_of_turn|&gt;
GPT4 Correct Assistant: I understand, and I will do this.&lt;|end_of_turn|&gt;
GPT4 Correct User: Excellent. The scenario will begin with your next reply.&lt;|end_of_turn|&gt;</code></pre>
</doc-codeblock></div>
<p>This prompt achieves 2 objectives:</p>
<ol>
<li>It replaces the awful default prompt with something related to chat and roleplaying</li>
<li>It follows OpenChat&#x27;s expected instruct style, including clear instructions</li>
</ol>
<p>Send &quot;That&#x27;s right. Come on in.&quot; to Betty, and let&#x27;s see what comes out on the console:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">'GPT4 Correct User: We will begin a fictional roleplaying chat where you will play Betty. \n' +
&quot;Write Betty's next reply in a fictional roleplay chat between User and Betty.\n&quot; +
'Write 1 paragraph reply only, italicize actions, and avoid quotation marks. Use markdown. Be proactive, creative, and drive the plot and conversation forward. Include dialog as well as narration.&lt;|end_of_turn|&gt;\n' +
'GPT4 Correct Assistant: I understand, and I will do this.&lt;|end_of_turn|&gt;\n' +
'GPT4 Correct User: Excellent. The scenario will begin with your next reply.&lt;|end_of_turn|&gt;\n' +
'Betty is a fresh graduate in business administration.\n' +
'***\n' +
'&lt;|end_of_turn|&gt;\n' +
&quot;Assistant: Hi, I'm Betty. I'm here for the job interview? I was told to report here.&lt;|end_of_turn|&gt;\n&quot; +
&quot;User: User: That's right. Come on in.&lt;|end_of_turn|&gt;\n&quot; +
'Assistant: ',</code></pre>
</doc-codeblock></div>
<p>We can spot 3 issues:</p>
<ol>
<li>SillyTavern is sending &#x27;Assistant:&#x27; instead of &#x27;GPT4 Correct Assistant:&#x27; once the chat actually starts</li>
<li>SillyTavern is sending &#x27;User:&#x27; instead of &#x27;GPT4 Correct User:&#x27;</li>
<li>Betty&#x27;s description is inserted in the middle without adhering to the OpenChat format: it&#x27;s not mentioned as part of a &#x27;GPT4 Correct User: blah blah &lt;|end_of_turn|&gt;&#x27; line.</li>
</ol>
<doc-anchor-target id="round-2-more-tweaks">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#round-2-more-tweaks">#</doc-anchor-trigger>
        <span>Round 2: more tweaks</span>
    </h4>
</doc-anchor-target>
<p>Issues #1 and #2 are an easy fix: under Instruct Mode Sequences, simply change Input Sequence from &#x27;User:&#x27; to &#x27;GPT4 Correct User:&#x27;, and Output Sequence&#x27;s &#x27;&lt;|end_of_turn|&gt; Assistant:&#x27; to &#x27;&lt;|end_of_turn|&gt; GPT4 Correct Assistant:&#x27; (NOTE: there&#x27;s a newline before GPT4 Correct Assistant, i.e. press Enter). You can save your preset and try again to confirm that solves these issues.</p>
<p>Now for the description. If you&#x27;re happy with Betty&#x27;s replies now, stop here. If you want to go deeper, read on.</p>
<doc-anchor-target id="round-3-optional-final-description-tweak">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#round-3-optional-final-description-tweak">#</doc-anchor-trigger>
        <span>Round 3 (optional): final description tweak</span>
    </h4>
</doc-anchor-target>
<p>You shouldn&#x27;t bother doing this if you&#x27;re happy with the model now. I&#x27;m showing it here to demonstrate how to make SillyTavern do your bidding when you do need to make a major change. This round of tweaks is more invasive and will discard the optional sections of a character card (scenario, personality, etc).</p>
<p>On the AI Response Formatting page, SillyTavern has a setting at the top called StoryString. This defines what SillyTavern will send to your model. For example, by default, it will send the system prompt (that&#x27;s the <code v-pre>{{system}}</code> entry), then <code v-pre>{{wiBefore}}</code> (World Info marker), then <code v-pre>{{description}}</code> which is the character description, then other stuff.</p>
<p>Create a new Context Template preset based on Default, by clicking the Save Preset As button at the top, and name it Starling. The formatting is unusual on that syntax because the closing <code v-pre>{{/if}}</code> must be on the next line, but basically, it follows the format <code v-pre>{{#if system}}{{system}}{{/if}}</code>. This says to send the LLM the system prompt if it exists, and it&#x27;s the same for all the other entries.</p>
<p>What we&#x27;re going to do is tell SillyTavern to stop sending the description as part of the Story String (which doesn&#x27;t let us customize it with &lt;|end_of_turn|&gt;).</p>
<p>So let&#x27;s replace:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">{{#if system}}{{system}}
{{/if}}{{#if wiBefore}}{{wiBefore}}
{{/if}}{{#if description}}{{description}}
{{/if}}{{#if personality}}{{char}}'s personality: {{personality}}
{{/if}}{{#if scenario}}Scenario: {{scenario}}
{{/if}}{{#if wiAfter}}{{wiAfter}}
{{/if}}{{#if persona}}{{persona}}
{{/if}}</code></pre>
</doc-codeblock></div>
<p>with:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">{{#if system}}{{system}}
{{/if}}</code></pre>
</doc-codeblock></div>
<p>Now there won&#x27;t be any description sent. So how are we supposed to give Betty&#x27;s description within the OpenChat format? Edit your system prompt to this:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">GPT4 Correct User: We will begin a fictional roleplaying chat where you will play {{char}}. 
Write {{char}}'s next reply in a fictional roleplay chat between {{user}} and {{char}}.
Write 1 reply only, italicize actions, and avoid quotation marks. Use markdown. Be proactive, creative, and drive the plot and conversation forward. Include dialog as well as narration.
Description of {{char}}: {{description}}&lt;|end_of_turn|&gt;
GPT4 Correct Assistant: I understand, and I will do this.&lt;|end_of_turn|&gt;
GPT4 Correct User: Excellent. The scenario will begin with your next reply.&lt;|end_of_turn|&gt;</code></pre>
</doc-codeblock></div>
<p>We just added <code v-pre>Description of {{char}}: {{description}}&lt;|end_of_turn|&gt;</code> to our system prompt. So although our Story String no longer sends the description, we send our system prompt, and our system prompt includes the description, so it&#x27;s all good.</p>
<p>(Note that we also removed several other things such as scenario, personality, etc. None of my characters use these optional fields so I didn&#x27;t bother covering them. You can do the same fix for those. You could write something in the system prompt like this e.g. scenario: &quot;If the following scenario definition is not empty, follow the scenario: SCENARIO DEFINITION: <code v-pre>{{scenario}}</code>.)</p>
<p>If you use persona descriptions or World Info, you <em>must</em> add their macro placeholders to the system prompt or story string, otherwise they will NOT be sent to a model. See <a href="https://docs.sillytavern.app/usage/core-concepts/advancedformatting/">Advanced Formatting</a> for a more in-depth explanation.</p>
<doc-anchor-target id="conclusion">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#conclusion">#</doc-anchor-trigger>
        <span>Conclusion</span>
    </h3>
</doc-anchor-target>
<p>Chat with Betty and the output should speak for itself. She went from writing awful to doing decent roleplaying chat replies. So whenever you&#x27;re using the Starling model, you should be using your new Starling presets in ST.</p>
<p>Example output from Betty now (which you can improve further by modifying the system prompt as you wish):</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">*Betty steps into the room and scans her surroundings, taking note of the tasteful furnishings and the air of professionalism that fills the space.*

Hey, I appreciate you inviting me for this interview. My name is Betty, and I recently graduated with a degree in business administration. I'm excited to learn more about this opportunity and see if it's a good fit for both of us.</code></pre>
</doc-codeblock></div>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer class="clear-both">
                                <div class="flex flex-wrap items-center justify-between mt-14">
                                    <a class="my-2.5 inline-flex items-center text-sm whitespace-nowrap text-blue-500 dark:text-blue-400 hover:text-blue-700 hover:underline" href="https://github.com/SillyTavern/SillyTavern-Docs/edit/main/Usage/Local LLM Guide/How To Improve Output Quality.md" target="_blank" rel="noopener">
                                        <svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M20 12c-.55 0-1 .45-1 1v7c0 .55-.45 1-1 1H4c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h7c.55 0 1-.45 1-1s-.45-1-1-1H4C2.35 3 1 4.35 1 6v14c0 1.65 1.35 3 3 3h14c1.65 0 3-1.35 3-3v-7c0-.55-.45-1-1-1z" /><path d="M22.21 1.79c-1.18-1.18-3.24-1.18-4.41 0l-9.5 9.5c-.13.13-.22.29-.26.46l-1 4c-.08.34.01.7.26.95.18.2.44.3.7.3.08 0 .16-.01.24-.03l4-1c.18-.04.34-.13.46-.26l9.5-9.5c1.22-1.22 1.22-3.2.01-4.42zm-1.42 3l-9.3 9.3-2.11.53.53-2.11 9.3-9.3c.42-.42 1.16-.42 1.59 0 .43.43.43 1.15-.01 1.58z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        <span>Edit this page</span>
                                    </a>
                                </div>
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../../usage/local-llm-guide/how-to-use-a-self-hosted-model/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">Self-​hosted AI models</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../../../usage/branches/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">Branches</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"><p>© Copyright 2024. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "How To Improve Output Quality", level: 3, icon: "file", hasPrism: false, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
